/*!
 * chartjs-plugin-dragdata v2.3.1
 * https://github.com/artus9033/chartjs-plugin-dragdata.git
 * (c) 2018-2024 chartjs-plugin-dragdata contributors
 * Released under the MIT license
 */
import{getRelativePosition as t}from"chart.js/helpers";import{Chart as n}from"chart.js";var e={value:()=>{}};function i(){for(var t,n=0,e=arguments.length,i={};n<e;++n){if(!(t=arguments[n]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new r(i)}function r(t){this._=t}function o(t,n){for(var e,i=0,r=t.length;i<r;++i)if((e=t[i]).name===n)return e.value}function a(t,n,i){for(var r=0,o=t.length;r<o;++r)if(t[r].name===n){t[r]=e,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=i&&t.push({name:n,value:i}),t}r.prototype=i.prototype={constructor:r,on:function(t,n){var e,i,r=this._,u=(i=r,(t+"").trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");if(e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))),l=-1,s=u.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++l<s;)if(e=(t=u[l]).type)r[e]=a(r[e],t.name,n);else if(null==n)for(e in r)r[e]=a(r[e],t.name,null);return this}for(;++l<s;)if((e=(t=u[l]).type)&&(e=o(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new r(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,i,r=new Array(e),o=0;o<e;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(i=this._[t]).length;o<e;++o)i[o].value.apply(n,r)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};var u="http://www.w3.org/1999/xhtml",l={svg:"http://www.w3.org/2000/svg",xhtml:u,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function s(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),l.hasOwnProperty(n)?{space:l[n],local:t}:t}function c(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===u&&n.documentElement.namespaceURI===u?n.createElement(t):n.createElementNS(e,t)}}function f(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function d(t){var n=s(t);return(n.local?f:c)(n)}function h(){}function v(t){return null==t?h:function(){return this.querySelector(t)}}function p(){return[]}function g(t){return function(){return null==(n=t.apply(this,arguments))?[]:Array.isArray(n)?n:Array.from(n);var n}}function y(t){return function(n){return n.matches(t)}}var m=Array.prototype.find;function _(){return this.firstElementChild}var x=Array.prototype.filter;function w(){return Array.from(this.children)}function D(t){return new Array(t.length)}function A(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function b(t,n,e,i,r,o){for(var a,u=0,l=n.length,s=o.length;u<s;++u)(a=n[u])?(a.__data__=o[u],i[u]=a):e[u]=new A(t,o[u]);for(;u<l;++u)(a=n[u])&&(r[u]=a)}function I(t,n,e,i,r,o,a){var u,l,s,c=new Map,f=n.length,d=o.length,h=new Array(f);for(u=0;u<f;++u)(l=n[u])&&(h[u]=s=a.call(l,l.__data__,u,n)+"",c.has(s)?r[u]=l:c.set(s,l));for(u=0;u<d;++u)s=a.call(t,o[u],u,o)+"",(l=c.get(s))?(i[u]=l,l.__data__=o[u],c.delete(s)):e[u]=new A(t,o[u]);for(u=0;u<f;++u)(l=n[u])&&c.get(h[u])===l&&(r[u]=l)}function S(t){return t.__data__}function E(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function M(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function P(t){return function(){this.removeAttribute(t)}}function N(t){return function(){this.removeAttributeNS(t.space,t.local)}}function C(t,n){return function(){this.setAttribute(t,n)}}function k(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function T(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function j(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function O(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function V(t){return function(){this.style.removeProperty(t)}}function B(t,n,e){return function(){this.style.setProperty(t,n,e)}}function L(t,n,e){return function(){var i=n.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,e)}}function q(t){return function(){delete this[t]}}function U(t,n){return function(){this[t]=n}}function X(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function F(t){return t.trim().split(/^|\s+/)}function R(t){return t.classList||new Y(t)}function Y(t){this._node=t,this._names=F(t.getAttribute("class")||"")}function z(t,n){for(var e=R(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function H(t,n){for(var e=R(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function G(t){return function(){z(this,t)}}function K(t){return function(){H(this,t)}}function J(t,n){return function(){(n.apply(this,arguments)?z:H)(this,t)}}function Q(){this.textContent=""}function W(t){return function(){this.textContent=t}}function Z(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function $(){this.innerHTML=""}function tt(t){return function(){this.innerHTML=t}}function nt(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function et(){this.nextSibling&&this.parentNode.appendChild(this)}function it(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rt(){return null}function ot(){var t=this.parentNode;t&&t.removeChild(this)}function at(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function ut(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function lt(t){return function(){var n=this.__on;if(n){for(var e,i=0,r=-1,o=n.length;i<o;++i)e=n[i],t.type&&e.type!==t.type||e.name!==t.name?n[++r]=e:this.removeEventListener(e.type,e.listener,e.options);++r?n.length=r:delete this.__on}}}function st(t,n,e){return function(){var i,r=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(r)for(var a=0,u=r.length;a<u;++a)if((i=r[a]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=e),void(i.value=n);this.addEventListener(t.type,o,e),i={type:t.type,name:t.name,value:n,listener:o,options:e},r?r.push(i):this.__on=[i]}}function ct(t,n,e){var i=O(t),r=i.CustomEvent;"function"==typeof r?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}function ft(t,n){return function(){return ct(this,t,n)}}function dt(t,n){return function(){return ct(this,t,n.apply(this,arguments))}}A.prototype={constructor:A,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Y.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ht=[null];function vt(t,n){this._groups=t,this._parents=n}function pt(t){return"string"==typeof t?new vt([[document.querySelector(t)]],[document.documentElement]):new vt([[t]],ht)}function gt(t,n){if(t=function(t){let n;for(;n=t.sourceEvent;)t=n;return t}(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(n.getScreenCTM().inverse())).x,i.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop]}}return[t.pageX,t.pageY]}vt.prototype={constructor:vt,select:function(t){"function"!=typeof t&&(t=v(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a,u=n[r],l=u.length,s=i[r]=new Array(l),c=0;c<l;++c)(o=u[c])&&(a=t.call(o,o.__data__,c,u))&&("__data__"in o&&(a.__data__=o.__data__),s[c]=a);return new vt(i,this._parents)},selectAll:function(t){t="function"==typeof t?g(t):function(t){return null==t?p:function(){return this.querySelectorAll(t)}}(t);for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var a,u=n[o],l=u.length,s=0;s<l;++s)(a=u[s])&&(i.push(t.call(a,a.__data__,s,u)),r.push(a));return new vt(i,r)},selectChild:function(t){return this.select(null==t?_:function(t){return function(){return m.call(this.children,t)}}("function"==typeof t?t:y(t)))},selectChildren:function(t){return this.selectAll(null==t?w:function(t){return function(){return x.call(this.children,t)}}("function"==typeof t?t:y(t)))},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a=n[r],u=a.length,l=i[r]=[],s=0;s<u;++s)(o=a[s])&&t.call(o,o.__data__,s,a)&&l.push(o);return new vt(i,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,S);var e,i=n?I:b,r=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,u=new Array(a),l=new Array(a),s=new Array(a),c=0;c<a;++c){var f=r[c],d=o[c],h=d.length,v=E(t.call(f,f&&f.__data__,c,r)),p=v.length,g=l[c]=new Array(p),y=u[c]=new Array(p);i(f,d,g,y,s[c]=new Array(h),v,n);for(var m,_,x=0,w=0;x<p;++x)if(m=g[x]){for(x>=w&&(w=x+1);!(_=y[w])&&++w<p;);m._next=_||null}}return(u=new vt(u,r))._enter=l,u._exit=s,u},enter:function(){return new vt(this._enter||this._groups.map(D),this._parents)},exit:function(){return new vt(this._exit||this._groups.map(D),this._parents)},join:function(t,n,e){var i=this.enter(),r=this,o=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=n&&(r=n(r))&&(r=r.selection()),null==e?o.remove():e(o),i&&r?i.merge(r).order():r},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,i=n._groups,r=e.length,o=i.length,a=Math.min(r,o),u=new Array(r),l=0;l<a;++l)for(var s,c=e[l],f=i[l],d=c.length,h=u[l]=new Array(d),v=0;v<d;++v)(s=c[v]||f[v])&&(h[v]=s);for(;l<r;++l)u[l]=e[l];return new vt(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i,r=t[n],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=M);for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var a,u=e[o],l=u.length,s=r[o]=new Array(l),c=0;c<l;++c)(a=u[c])&&(s[c]=a);s.sort(n)}return new vt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r,o=n[e],a=0,u=o.length;a<u;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,n){var e=s(t);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((null==n?e.local?N:P:"function"==typeof n?e.local?j:T:e.local?k:C)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?V:"function"==typeof n?L:B)(t,n,null==e?"":e)):function(t,n){return t.style.getPropertyValue(n)||O(t).getComputedStyle(t,null).getPropertyValue(n)}(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?q:"function"==typeof n?X:U)(t,n)):this.node()[t]},classed:function(t,n){var e=F(t+"");if(arguments.length<2){for(var i=R(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each(("function"==typeof n?J:n?G:K)(e,n))},text:function(t){return arguments.length?this.each(null==t?Q:("function"==typeof t?Z:W)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?$:("function"==typeof t?nt:tt)(t)):this.node().innerHTML},raise:function(){return this.each(et)},lower:function(){return this.each(it)},append:function(t){var n="function"==typeof t?t:d(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:d(t),i=null==n?rt:"function"==typeof n?n:v(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(ot)},clone:function(t){return this.select(t?ut:at)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var i,r,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?st:lt,i=0;i<a;++i)this.each(u(o[i],n,e));return this}var u=this.node().__on;if(u)for(var l,s=0,c=u.length;s<c;++s)for(i=0,l=u[s];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,n){return this.each(("function"==typeof n?dt:ft)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i,r=t[n],o=0,a=r.length;o<a;++o)(i=r[o])&&(yield i)}};const yt={passive:!1},mt={capture:!0,passive:!1};function _t(t){t.stopImmediatePropagation()}function xt(t){t.preventDefault(),t.stopImmediatePropagation()}var wt=t=>()=>t;function Dt(t,{sourceEvent:n,subject:e,target:i,identifier:r,active:o,x:a,y:u,dx:l,dy:s,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:c}})}function At(t){return!t.ctrlKey&&!t.button}function bt(){return this.parentNode}function It(t,n){return null==n?{x:t.x,y:t.y}:n}function St(){return navigator.maxTouchPoints||"ontouchstart"in this}function Et(){var t,n,e,r,o=At,a=bt,u=It,l=St,s={},c=i("start","drag","end"),f=0,d=0;function h(t){t.on("mousedown.drag",v).filter(l).on("touchstart.drag",y).on("touchmove.drag",m,yt).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(i,u){if(!r&&o.call(this,i,u)){var l=x(this,a.call(this,i,u),i,u,"mouse");l&&(pt(i.view).on("mousemove.drag",p,mt).on("mouseup.drag",g,mt),function(t){var n=t.document.documentElement,e=pt(t).on("dragstart.drag",xt,mt);"onselectstart"in n?e.on("selectstart.drag",xt,mt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}(i.view),_t(i),e=!1,t=i.clientX,n=i.clientY,l("start",i))}}function p(i){if(xt(i),!e){var r=i.clientX-t,o=i.clientY-n;e=r*r+o*o>d}s.mouse("drag",i)}function g(t){pt(t.view).on("mousemove.drag mouseup.drag",null),function(t,n){var e=t.document.documentElement,i=pt(t).on("dragstart.drag",null);n&&(i.on("click.drag",xt,mt),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}(t.view,e),xt(t),s.mouse("end",t)}function y(t,n){if(o.call(this,t,n)){var e,i,r=t.changedTouches,u=a.call(this,t,n),l=r.length;for(e=0;e<l;++e)(i=x(this,u,t,n,r[e].identifier,r[e]))&&(_t(t),i("start",t,r[e]))}}function m(t){var n,e,i=t.changedTouches,r=i.length;for(n=0;n<r;++n)(e=s[i[n].identifier])&&(xt(t),e("drag",t,i[n]))}function _(t){var n,e,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<o;++n)(e=s[i[n].identifier])&&(_t(t),e("end",t,i[n]))}function x(t,n,e,i,r,o){var a,l,d,v=c.copy(),p=gt(o||e,n);if(null!=(d=u.call(t,new Dt("beforestart",{sourceEvent:e,target:h,identifier:r,active:f,x:p[0],y:p[1],dx:0,dy:0,dispatch:v}),i)))return a=d.x-p[0]||0,l=d.y-p[1]||0,function e(o,u,c){var g,y=p;switch(o){case"start":s[r]=e,g=f++;break;case"end":delete s[r],--f;case"drag":p=gt(c||u,n),g=f}v.call(o,t,new Dt(o,{sourceEvent:u,subject:d,target:h,identifier:r,active:g,x:p[0]+a,y:p[1]+l,dx:p[0]-y[0],dy:p[1]-y[1],dispatch:v}),i)}}return h.filter=function(t){return arguments.length?(o="function"==typeof t?t:wt(!!t),h):o},h.container=function(t){return arguments.length?(a="function"==typeof t?t:wt(t),h):a},h.subject=function(t){return arguments.length?(u="function"==typeof t?t:wt(t),h):u},h.touchable=function(t){return arguments.length?(l="function"==typeof t?t:wt(!!t),h):l},h.on=function(){var t=c.on.apply(c,arguments);return t===c?h:t},h.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,h):Math.sqrt(d)},h}Dt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Mt={id:"dragdata",statesStore:new Map,afterInit:function(t){var n={curIndex:void 0,curDatasetIndex:void 0,element:null,eventSettings:!1,floatingBar:!1,initValue:0,xAxisID:"",yAxisID:"",rAxisID:"",stacked:!1,type:void 0,isDragging:!1};Mt.statesStore.set(t.id,n),pt(t.canvas).call(Et().container(t.canvas).on("start",(function(e){return Lt(e.sourceEvent,t,n)})).on("drag",(function(e){return qt(e.sourceEvent,t,n)})).on("end",(function(e){return Bt(e.sourceEvent,t,n)})))},beforeEvent:function(t){var n,e=Mt.statesStore.get(t.id);if(null==e?void 0:e.isDragging)return null===(n=t.tooltip)||void 0===n||n.update(),!1}};function Pt(t,n){return void 0===n||isNaN(n)||n<0?t:Math.round(t*Math.pow(10,n))/Math.pow(10,n)}function Nt(t,n,e){return Math.min(Math.max(t,n),e)}function Ct(n,e,i,r,o){var a,u,l;void 0===o&&(o=Mt.statesStore.get(e.id));var s=t(n,e),c=s.x,f=s.y,d=e.scales[r],h=d.getPointPositionForValue(i+("polarArea"===(null==o?void 0:o.type)?.5:0),e.scales[r].max).angle,v=d.xCenter,p=d.yCenter,g=f-p,y=(c-v)*Math.cos(h)+g*Math.sin(h)>0?Math.sqrt(Math.pow(c-v,2)+Math.pow(f-p,2)):0,m=d.getValueForDistanceFromCenter(y);return m=Nt(m=Pt(m,null===(l=null===(u=null===(a=e.config.options)||void 0===a?void 0:a.plugins)||void 0===u?void 0:u.dragData)||void 0===l?void 0:l.round),e.scales[r].min,e.scales[r].max)}n.register(Mt);var kt=function(){return kt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},kt.apply(this,arguments)};function Tt(t){return Array.isArray(t)?function(t,n,e){if(e||2===arguments.length)for(var i,r=0,o=n.length;r<o;r++)!i&&r in n||(i||(i=Array.prototype.slice.call(n,0,r)),i[r]=n[r]);return t.concat(i||Array.prototype.slice.call(n))}([],t,!0):"object"==typeof t?kt({},t):t}function jt(n,e,i,r,o){var a,u,l,s,c,f=r.xAxisDraggingDisabled,d=r.yAxisDraggingDisabled;if(void 0===o&&(o=Mt.statesStore.get(e.id)),!o)return i;var h=Tt(i),v=t(n,e),p=v.x,g=v.y,y=e.scales[o.xAxisID].getValueForPixel(p),m=e.scales[o.yAxisID].getValueForPixel(g),_=null===(l=null===(u=null===(a=e.config.options)||void 0===a?void 0:a.plugins)||void 0===u?void 0:u.dragData)||void 0===l?void 0:l.round;if(y=Pt(y,_),m=Pt(m,_),y=Nt(y,e.scales[o.xAxisID].min,e.scales[o.xAxisID].max),m=Nt(m,e.scales[o.yAxisID].min,e.scales[o.yAxisID].max),o.floatingBar){var x=void 0;return x="y"===(null===(s=e.config.options)||void 0===s?void 0:s.indexAxis)?y:m,Math.abs(x-h[0])<=Math.abs(x-h[1])?h[0]=x:h[1]=x,h}return void 0===h.x||f||(h.x=y),void 0!==h.y?(d||(h.y=m),h):"y"===(null===(c=e.config.options)||void 0===c?void 0:c.indexAxis)?f?h:y:d?h:m}function Ot(t,n,e){var i,r,o=null===(r=null===(i=t.config.options)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.dragData;if(null==o?void 0:o.magnet){var a=null==o?void 0:o.magnet;if("function"==typeof a.to){var u=t.data.datasets[n].data[e];return u=a.to(u),t.data.datasets[n].data[e]=u,t.update("none"),u}return null}return t.data.datasets[n].data[e]}function Vt(t,n,e,i){var r,o,a,u,l,s,c,f,d,h,v,p,g,y,m;if(void 0===i&&(i=Mt.statesStore.get(t.id)),!i)return{chartDraggingDisabled:!0,datasetDraggingDisabled:!0,xAxisDraggingDisabled:!0,yAxisDraggingDisabled:!0,dataPointDraggingDisabled:!0};var _=t.data.datasets[n],x=!1===(null===(o=null===(r=t.config.options)||void 0===r?void 0:r.plugins)||void 0===o?void 0:o.dragData),w=x||!1===_.dragData,D=null===(l=null===(u=null===(a=t.config.options)||void 0===a?void 0:a.scales)||void 0===u?void 0:u[i.xAxisID])||void 0===l?void 0:l.dragData,A=!0;return w||!0!==D&&(!0!==(null===(f=null===(c=null===(s=t.config.options)||void 0===s?void 0:s.plugins)||void 0===c?void 0:c.dragData)||void 0===f?void 0:f.dragX)||!1===D)||(A=!1),{chartDraggingDisabled:x,datasetDraggingDisabled:w,xAxisDraggingDisabled:A,yAxisDraggingDisabled:w||!1===(null===(v=null===(h=null===(d=t.config.options)||void 0===d?void 0:d.plugins)||void 0===h?void 0:h.dragData)||void 0===v?void 0:v.dragY)||!1===(null===(y=null===(g=null===(p=t.config.options)||void 0===p?void 0:p.scales)||void 0===g?void 0:g[i.yAxisID])||void 0===y?void 0:y.dragData),dataPointDraggingDisabled:w||!1===(null===(m=_.data[e])||void 0===m?void 0:m.dragData)}}function Bt(t,n,e){var i,r,o,a,u;if(void 0===e&&(e=Mt.statesStore.get(n.id)),e){var l=null===(o=null===(r=null===(i=n.options)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.dragData)||void 0===o?void 0:o.onDragEnd;if(e.curIndex=void 0,e.isDragging=!1,(null===(u=null===(a=n.config.options)||void 0===a?void 0:a.plugins)||void 0===u?void 0:u.tooltip)&&(n.config.options.plugins.tooltip.animation=e.eventSettings,n.update("none")),"function"==typeof l&&e.element){var s=e.element.datasetIndex,c=e.element.index;return l(t,s,c,Ot(n,s,c))}}}function Lt(t,n,e){var i,r,o,a,u,l,s,c,f,d,h,v,p,g,y,m,_,x,w,D,A,b,I,S,E,M;void 0===e&&(e=Mt.statesStore.get(n.id));var P=null===(o=null===(r=null===(i=n.options)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.dragData)||void 0===o?void 0:o.onDragStart;if(e){var N=null!==(l=null===(u=null===(a=n.config.options)||void 0===a?void 0:a.interaction)||void 0===u?void 0:u.mode)&&void 0!==l?l:"nearest",C=null!==(c=null===(s=n.config.options)||void 0===s?void 0:s.interaction)&&void 0!==c?c:{intersect:!0};if(e.element=n.getElementsAtEventForMode(t,N,C,!1)[0],e.element){var k=e.element.datasetIndex,T=e.element.index;e.type=null!==(d=null!==(f=n.config.type)&&void 0!==f?f:n.data.datasets[k].type)&&void 0!==d?d:void 0,e.eventSettings=null===(p=null===(v=null===(h=n.config.options)||void 0===h?void 0:h.plugins)||void 0===v?void 0:v.tooltip)||void 0===p?void 0:p.animation;var j=n.data.datasets[k],O=n.getDatasetMeta(k),V=j.data[T];e.xAxisID=O.xAxisID,e.yAxisID=O.yAxisID,e.rAxisID=O.rAxisID;var B=Vt(n,k,T),L=B.datasetDraggingDisabled,q=B.xAxisDraggingDisabled,U=B.yAxisDraggingDisabled,X=B.dataPointDraggingDisabled;if(L||q&&U||X)return void(e.element=null);if("bar"===e.type){e.stacked=null!==(_=null===(m=null===(y=null===(g=n.config.options)||void 0===g?void 0:g.scales)||void 0===y?void 0:y[e.xAxisID])||void 0===m?void 0:m.stacked)&&void 0!==_?_:void 0;var F=n.data.datasets[0].data[0];e.floatingBar=null!==F&&Array.isArray(F)&&F.length>=2;var R=jt(t,n,n.data.datasets[k].data[T],B,e);e.initValue=R-V}var Y=null===(D=null===(w=null===(x=n.config.options)||void 0===x?void 0:x.plugins)||void 0===w?void 0:w.dragData)||void 0===D?void 0:D.showTooltip;void 0!==Y&&!0!==Y||(null!==(A=(S=n.config).options)&&void 0!==A||(S.options={}),null!==(b=(E=n.config.options).plugins)&&void 0!==b||(E.plugins={}),null!==(I=(M=n.config.options.plugins).tooltip)&&void 0!==I||(M.tooltip={}),n.config.options.plugins.tooltip.animation=!1),"function"==typeof P&&e.element&&!1===P(t,k,T,V)&&(e.element=null)}}}function qt(t,n,e){var i,r;if(void 0===e&&(e=Mt.statesStore.get(n.id)),e){var o=null===(r=null===(i=n.options)||void 0===i?void 0:i.plugins)||void 0===r?void 0:r.dragData,a=null==o?void 0:o.onDrag;if(e.element){e.curDatasetIndex=e.element.datasetIndex,e.curIndex=e.element.index,e.isDragging=!0;var u=n.data.datasets[e.curDatasetIndex].data[e.curIndex],l=Vt(n,e.curDatasetIndex,e.curIndex);if("radar"===e.type||"polarArea"===e.type)u=Ct(t,n,e.curIndex,e.rAxisID,e);else if(e.stacked){u=Pt(jt(t,n,u,l,e)-e.initValue,null==o?void 0:o.round)}else u=jt(t,n,u,l,e);"function"==typeof a&&!1===a(t,e.curDatasetIndex,e.curIndex,u)||(n.data.datasets[e.curDatasetIndex].data[e.curIndex]=u,n.update("none"))}}}"function"==typeof SuppressedError&&SuppressedError;export{Ot as applyMagnet,jt as calcCartesian,Ct as calcRadialLinear,Vt as checkDraggingConfiguration,Nt as clipValue,Tt as cloneDataPoint,Mt as default,Bt as dragEndCallback,Lt as getElement,Pt as roundValue,qt as updateData};
